TO_EXCLUDE_HOME_ENTRIES=(/home/*/{Downloads,.cargo,.rustup,.cache/{JetBrains,chromium,go-build,google-chrome,mozilla,thumbnails},.config/google-chrome,.local/share,.m2,.mozilla,.nuget,.npm,.thunderbird,.gradle,.fotoxx/thumbnails,.node-gyp,.eclipse,.vscode,.surf,.googleearth,.netbeans,.thumbnails,.ganttproject.d,.gephi,.smartgit,.kube/cache,.zoom,tmp,VirtualBox\ VMs,*/{.git,.angular,target,node_modules},*/*/{.git,.angular,target,node_modules},*/*/*/{.git,.angular,target,node_modules},*/*/*/*/{.git,.angular,target,node_modules},*/*/*/*/*/{.git,.angular,target,node_modules},*/*/*/*/*/*/{.git,.angular,target,node_modules},*/*/*/*/*/*/*/{.git,.angular,target,node_modules},*/*/*/*/*/*/*/*/{.git,.angular,target,node_modules},*/*/*/*/*/*/*/*/*/{.git,.angular,target,node_modules},*/*/*/*/*/*/*/*/*/*/{.git,.angular,target,node_modules}}); block="1024k"; (sleep 5; pid=`pgrep mksquashfs`; sudo chrt -i -p 0 $pid; sudo renice -n 20 $pid; sudo ionice -c 3 -p $pid) & nice -n 20 mksquashfs /home "/tmp/experimental.home.sfs" -always-use-fragments -comp xz -b ${block} -Xdict-size ${block} -progress -ef <(for i in "${TO_EXCLUDE_HOME_ENTRIES[@]}"; do echo $i; done)

# after mounting the generated sfs home in the local foldar, verify remaining files with
diff -qrs "/home" "." 2>/dev/null | grep -E '^Only in /home|^Files .* differ$' | sed "s|^Only in \(.*\): \(.*\)|\1/\2|; s|^Files \(.*\) and ./.*$|\1|" | while read f; do echo "$f"; echo -en '.'; done | less -# 1
