Install to HD
=============

1) Run GParted and create, at least, partitions for swap (same size as RAM) and root (ext4 formatted with: )
2) Review and run the following command, as root, to install: targetDev=/dev/sda2; targetHD=/dev/sda; mkfs.ext4 -b 4096 -E resize=$((512*(1024*1024*1024)/4096)),stride=32,stripe-width=32,packed_meta_blocks=1,discard -m 0 -O flex_bg $targetDev && tune2fs -L "MutuaTechLinux" -c 3 -e remount-ro -o discard,journal_data_writeback,nobarrier $targetDev && mkdir -p /tmp/hd && mount $targetDev /tmp/hd && rsync -a --info=progress2 /bin /boot /etc /home /lib /lib64 /mnt /opt /root /sbin /srv /usr /var /tmp/hd; mkdir /tmp/hd/dev /tmp/hd/proc /tmp/hd/run /tmp/hd/sys /tmp/hd/tmp && blkid "${targetHD}"*
3) From the output of the last command above, blkid, set the following variables and run the commands: rootUUID="xxxx"; swapUUID="yyyy"; windowsUUID="zzzz"; echo -en "UUID=$rootUUID\t/\text4\trw,relatime\t0 1\nUUID=$swapUUID\tswap\tswap\tdefaults\t0 0\n" >/tmp/hd/etc/fstab; fragment='gnulinux-simple-'; oldRootUUID=`grep "$fragment" /tmp/hd/boot/grub/grub.cfg | head -n 1 | sed "s|.*${fragment}\([^ ']*\).*|\1|"`; fragment='resume=UUID='; oldSwapUUID=`grep "$fragment" /tmp/hd/boot/grub/grub.cfg | head -n 1 | sed "s|.*${fragment}\([^ ']*\).*|\1|"`; fragment='osprober-chain-'; oldWindowsUUID=`grep "$fragment" /tmp/hd/boot/grub/grub.cfg | head -n 1 | sed "s|.*${fragment}\([^ ']*\).*|\1|"`; sed -ie "s|$oldRootUUID|${rootUUID}|g" /tmp/hd/boot/grub/grub.cfg && sed -ie "s|$oldSwapUUID|${swapUUID}|g" /tmp/hd/boot/grub/grub.cfg && sed -ie "s|$oldWindowsUUID|${windowsUUID}|g" /tmp/hd/boot/grub/grub.cfg && sed -ie "s|root=PARTUUID=[^ ]*|root=UUID=${rootUUID}|g" /tmp/hd/boot/grub/grub.cfg && grub-install --no-floppy --boot-directory=/tmp/hd/boot $targetHD
